# recce.yml

checks:
  # ‚úÖ Check 1: Conteo de filas
  - name: Row count diff for modified tables
    description: Check the row count difference for modified models and their downstream dependencies.
    type: row_count_diff
    params:
      select: state:modified+
      threshold: 0.05  # (Opcional) Permite hasta un 5% de diferencia

  # ‚úÖ Check 2: Diferencias en el esquema (columnas, tipos, etc.)
  - name: Schema diff for modified nodes
    description: Check the schema difference for all modified nodes and their downstream dependencies.
    type: schema_diff
    params:
      select: state:modified+

  # üßÆ Check 3: Comparaci√≥n de valores agregados clave
  - name: Aggregated metric comparison
    description: Compare sum and average of key numeric fields for modified models.
    type: aggregate_diff
    params:
      select: state:modified+
      aggregates:
        - sum
        - avg
      columns:
        - amount
        - revenue
        - total_sales
      threshold: 0.01  # 1% de tolerancia

  # üïµÔ∏è Check 4: Duplicados en columnas clave
  - name: Check for duplicate keys in modified tables
    description: Ensure there are no duplicate primary key values in modified models.
    type: duplicate_check
    params:
      select: state:modified+
      key_columns:
        - order_id
        - customer_id

  # üö´ Check 5: Nulos inesperados en columnas cr√≠ticas
  - name: Null value check for critical columns
    description: Validate that key columns have no unexpected nulls in modified models.
    type: null_check
    params:
      select: state:modified+
      columns:
        - order_id
        - customer_id
        - amount
